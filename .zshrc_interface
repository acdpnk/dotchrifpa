# allow for functions in the prompt
	
	setopt PROMPT_SUBST

# general environment

	AUTO_CD=true
	autoload -U colors && colors

# i found this one and don't quite grasp it yet. when changing directories it checks whether the current terminal is an xterm window or *something* (?) similar, and if so prints current directory to the title bar.

	chpwd() {
		[[ -t 1 ]] || return
		case $TERM in
		sun-cmd) print -Pn "\e]l%~\e\\"
		;;
		*xterm*|rxvt|(dt|k|E)term) print -Pn "\e]2; [%n@%M]   [/dev/%y]   [$(pwd)] \a"
		;;
		esac
		}
	chpwd #calling it so that the title bar is as designed directly after logging in

# functions

	function isgit {
		git branch &>/dev/null && echo 1 && return
		echo 0
	}

	function gitisclean {
		if [[ $(isgit) == "1" ]] && [[ $(git status 2>&1 | grep -c clean) == "0" ]]; then
			echo •
		fi
	}

	function gitbranch {
		if [[ $(isgit) == "1" ]]; then
			echo -n ' on '
			git rev-parse --abbrev-ref HEAD 2>/dev/null
		fi
	}

	function prompt_char {
		if [[ $UID == 0 ]]; then
			echo '#'
			return
		fi
		git branch >/dev/null 2>/dev/null && echo '±' && return
	#	hg root >/dev/null 2>/dev/null && echo '☿' && return
		echo '$'
	}


	function batperc {
		if [[ $(hostname) == "lipstick" ]]; then
			if [[ $(acpi | grep -i -c "Discharging") != "1" ]]; then
				charge=⚡
			else
				charge=''
			fi
			if [[ $(acpi | grep -i -c "warning") == "1" ]]; then
				charge=%{$fg_bold[red]%}'!'%{$reset_color%}
			fi
			echo '['$(acpi | grep -E -o "1?[0-9]?[0-9]%" | sed s/"%"/"%%"/)$charge']'
		fi
	}

# prompt

	PROMPT=$'
┌[%n@%m][%c$(gitbranch)$(gitisclean)]
└[%j]$(prompt_char)> '
	PS2=$' ~> ' 
	RPROMPT='[%T]$(batperc)'
